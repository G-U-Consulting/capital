<div v-if="mode == 0" style="padding: 1em">
    <div class="pure-u-1-24 pure-u-md-1-24"></div>
    <div class="pure-u-22-24 pure-u-md-22-24 menuCard">
        <div class='pure-u-1-1 pure-u-md-1-1 formDivision'
            style="font-size: 1.5em; margin-bottom: 4px; margin-left: 1rem;">
            Administrar Bancos - {{nombrePro}}
        </div>
        <div class="searchBox">
            <div class="pure-g">
                <div class="pure-u-1-1 pure-u-md-10-24">
                    <input type="text" placeholder="Nombre" v-model="filtros.bancos['banco']" maxlength="50" />
                </div>
                <div class="pure-u-1-1 pure-u-md-2-24">
                    <div class="imgGraybutton" @click="onClear('bancos')">
                        <img src="./img/ico/eraser.png" />
                    </div>
                </div>
            </div>
        </div>
        <div class="main-content">
            <table class="dataTable" style="table-layout: auto;" v-if="bancos && bancos.length">
                <thead>
                    <tr>
                        <th
                            v-for="key in Object.keys(bancos[0]).filter(k => !k.startsWith('id_') && !k.startsWith('is_') )">
                            {{(key[0].toUpperCase() + key.substr(1)).replaceAll("_"," ")}}
                        </th>
                        <th v-for="fact in new Set(factores.map(f => f.factor))">{{fact}}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="banco in getFilteredList('bancos')" @click="onSelectBanco(banco)">
                        <td
                            v-for="key in Object.keys(banco).filter(k => !k.startsWith('id_') && !k.startsWith('is_') )">
                            {{banco[key]}}</td>
                        <td v-for="fact in new Set(factores.map(f => f.factor))" style="text-align: center;">
                            {{has_factor(banco.id_banco, fact) || "❌"}}
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<div v-if="mode == 1 || mode == 2" style="padding: 1em; height: max-content;" class="pure-g">
    <div class="pure-u-1-24 pure-u-md-1-24"></div>
    <div class="pure-u-22-24 pure-u-md-22-24 menuCard">
        <h2>Editar Banco</h2>
        <div class="pure-g">
            <div class="formInputStandard pure-u-1-2 pure-u-md-1-2" style="padding-left: 0">
                <input type="text" v-model="banco.banco" readonly disabled />
            </div>
            <div class="formInputStandard pure-u-1-2 pure-u-md-1-5">
                <button v-on:click="req(reset)">Reestablecer</button>
            </div>
        </div>

        <div class="pure-g">
            <div class="pure-u-1-1 pure-u-md-1-1">
                <div style="max-height: calc(100vh - 18.5rem); overflow-y: auto;">
                    <div v-for="unidad in new Set(factores.map(f => f.unidad))">
                        <h3>Valores en {{unidad}}</h3>
                        <table class="dataTable">
                            <thead>
                                <tr>
                                    <th>
                                        <span>Fact./ millón</span>
                                    </th>
                                    <th v-for="factor in factores.filter(f => f.unidad == unidad)">
                                        <span>{{factor.factor}}</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody style="font-size: 15px;">
                                <tr v-for="tf in tipos_factor">
                                    <td style="text-align: center; padding: 3px;">
                                        <span>
                                            {{tf.tipo_factor}}
                                        </span>
                                    </td>
                                    <td style="padding: 0;" v-for="factor in factores.filter(f => f.unidad == unidad)">
                                        <input type="text" class="banco_factor"
                                            :value="formatNumber(banco_factor[tf.id_tipo_factor][factor.id_factor].valor, false)"
                                            @input="banco_factor[tf.id_tipo_factor][factor.id_factor].valor = cleanNumber($event.target.value)">
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class='pure-u-1-1 pure-u-md-2-5'></div>
                <div class='pure-u-1-1 pure-u-md-1-5'>
                    <button v-on:click="onUpdateFactor()" style="margin-top: .8rem;">Guardar</button>
                </div>
            </div>
        </div>
    </div>
</div>