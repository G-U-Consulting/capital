<div style="display: inline;" v-for="(r, i) in ruta.filter(r => r.text)" @click="r.action">
    <span class="hoverLink">{{ r.text }}</span>
    <span v-if="i < ruta.length - 1"> / </span>
</div>

<div style="padding: 1em">
    <div class="pure-u-1-24 pure-u-md-1-24"></div>
    <div class="pure-u-22-24 pure-u-md-22-24 menuCard" style="height: calc(100vh - 8rem)">
        <h2 style="margin-bottom: .5rem;">{{sala.sala_venta}}</h2>
        <div class='pure-u-1-3 pure-u-md-9-24 formDivision' style="font-size: 1.5em; margin-bottom: 4px;">
            Fecha actual: {{ formatDatetime(null, 'date') }}
        </div>
        <div class='pure-u-2-3 pure-u-md-5-8 formDivision' style="font-size: 1.5em; margin-bottom: 4px;">
            Fecha seleccionada: {{ formatDatetime(null, 'date', selDate) }}
        </div>
        <div class="pure-u-1-1 pure-u-md-7-24">
            <div class="btn-view-group">
                <div class="radio-group" style="gap: 1rem; padding-top: 4px;">
                    <input type="radio" name="view" id="view-m6" :checked="viewMode.class == 'm6'"
                        @click="updateViewMode('m6')" />
                    <label for="view-m6" style="margin-bottom: .5rem; text-align: center;">
                        <span>6 meses</span>
                    </label>
                    <input type="radio" name="view" id="view-m12" :checked="viewMode.class == 'm12'"
                        @click="updateViewMode('m12')" />
                    <label for="view-m12" style="margin-bottom: .5rem; text-align: center;">
                        <span>12 meses</span>
                    </label>
                </div>
            </div>
        </div>
        <div class="pure-u-1-1 pure-u-md-1-12"></div>
        <div class="pure-u-1-1 pure-u-md-3-8">
            <div class="btn-view-group">
                <div class="radio-group" style="gap: 1rem; padding-top: 4px;">
                    <button style="margin-bottom: .5rem; padding: 5px .5rem;" @click="openModal(1)">Agregar
                        Hito</button>
                    <button style="margin-bottom: .5rem; padding: 5px .5rem;" @click="toggleHoliday">
                        {{day.isHoliday ? 'Desmarcar festivo' : 'Marcar como festivo'}}
                    </button>
                </div>
            </div>
        </div>
        <div class="pure-u-1-1 pure-u-md-1-4" style="text-align: end;">
            <div @click="!isToday() && setToday()" class="cal-btn today"
                :style="isToday() ? 'background-color: #636363;' : ''">Ir a Hoy</div>
            <div @click="setDate(-1)" class="cal-btn"
                style="border-top-right-radius: 0; border-bottom-right-radius: 0;">&lt;</div>
            <div @click="setDate(1)" class="cal-btn" style="border-top-left-radius: 0; border-bottom-left-radius: 0;">
                &gt;</div>
        </div>
        <div :class="'calendar pure-u-1-1 pure-u-md-1-1 ' + viewMode.class">
            <div class="cal-month" v-for="i in Array.from({length: viewMode.months}, (_, i) => i + viewMode.initMonth)"
                v-bind:class="{'cal-sel-month': viewMonths[nameMonths[i]].selected}">
                <div class="cal-header">
                    <div class="cal-name-month">
                        <span>{{`${nameMonths[i]} - ${viewMonths[nameMonths[i]].year}`}}</span>
                    </div>
                </div>
                <div class="cal-header">
                    <div class="cal-name-day" v-for="name in nameDays">
                        <span>{{name}}</span>
                    </div>
                </div>
                <div class="cal-matrix">
                    <div class="cal-day" v-for="day in viewMonths[nameMonths[i]].days" v-bind:class="{'cal-today': day.isToday, 'cal-fade-day': !day.currentMonth, 
                            'cal-sel-day': day.isSelected, 'cal-holiday': day.isHoliday}"
                        @click="day.currentMonth && selDay(day, i)" :style="day.events && day.events.filter(e => e.festivo != '1').length ? 
                            `background-color: ${day.events.filter(e => e.festivo != '1')[0].color}40;` : ''"
                        @dblclick="day.events && day.events.filter(e => e.festivo != '1').length && openModal(3)">
                        <span>
                            {{day.monthDay}}
                        </span>
                        <div class="hide-editor" v-bind:class="{'cal-event-count': day.events && 
                            day.events.filter(e => e.festivo != '1').length}">
                            <span>{{day.events.filter(e => e.festivo != '1').length}}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-overlay" id="modalOverlay" @click="closeModal($event)">
        <div class="modal-content pure-g" v-if="mode == 1 || mode == 2">
            <img src="../../img/ico/svg/cerrar-transparente.svg" @click="closeModal($event, true)" class="modal-cerrar">
            <div class='pure-u-1-1 pure-u-md-1-1'>
                <h2 style="text-align: center;">{{ formatDatetime(null, 'date', selDate) }}</h2>
            </div>
            <div class='pure-u-1-1 pure-u-md-1-1 formInputStandard'>
                <span>Titulo</span>
                <input type='text' maxlength="100" v-model="hito.titulo" />
            </div>
            <div class='pure-u-1-3 pure-u-md-1-3 formInputStandard'>
                <span>Hora</span>
                <input type='time' v-model="hito.hora" />
            </div>
            <div class='pure-u-1-6 pure-u-md-1-6 formInputStandard' style="text-align: center;">
                <span>Color</span>
                <input type='color' v-model="hito.color" />
            </div>
            <div class='pure-u-1-2 pure-u-md-1-2 formInputStandard' style="text-align: center;">
                <span style="margin-left: 22px;">Aplica para</span>
                <div style="display: flex; justify-content: space-around; padding-top: 5px;">
                    
                    <label for="rad-pro"><input type="radio" name="event-type" id="rad-pro" :checked="hitoPro"
                        @change="hitoPro = true" /><span>Proyecto ({{proyecto.nombre}})</span></label>
                    
                    <label for="rad-sala"><input type="radio" name="event-type" id="rad-sala" :checked="!hitoPro"
                        @change="hitoPro = false" /><span>Sala</span></label>
                </div>
            </div>
            <div class='pure-u-1-1 pure-u-md-1-1 formInputStandard'>
                <span>Descripci√≥n</span>
                <textarea maxlength="255" v-model="hito.descripcion"
                    style="width: 100%; height: 100px; resize: none; font-size: 14px;"></textarea>
            </div>
            <div class='pure-u-1-1 pure-u-md-1-6 formInputStandard'></div>
            <div class='pure-u-1-1 pure-u-md-1-3 formInputStandard'>
                <button @click="onCancel">Cancelar</button>
            </div>
            <div class='pure-u-1-1 pure-u-md-1-3 formInputStandard'>
                <button @click="onSave">Guardar</button>
            </div>
        </div>

        <div class="modal-content pure-g" v-if="mode == 3">
            <img src="../../img/ico/svg/cerrar-transparente.svg" @click="closeModal($event, true)" class="modal-cerrar">
            <div class="pure-u-1-1">
                <h2 style="text-align: center; margin-bottom: 1rem;">
                    Hitos del {{ formatDatetime(null, 'date', selDate) }}
                </h2>
            </div>
            <div class="event-list">
                <div v-for="e in day.events.filter(e => e.festivo != '1')" class="event-card pure-g"
                    :style="`border: 1px solid ${e.color}90; border-left: 6px solid ${e.color}; background-color: ${e.color}10;`">
                    <div class="pure-u-5-6 pure-u-md-5-6">
                        <h4 class="event-title">
                            {{ e.titulo }} - {{ e.id_proyecto ? proyecto.nombre : sala.sala_venta }} - {{
                            formatDatetime(e.fecha, 'time') }}
                        </h4>
                        <p class="event-description">{{ e.descripcion }}</p>
                    </div>
                    <div class="event-edit-btn pure-u-1-12 pure-u-md-1-12">
                        <img src="../../img/ico/svg/pencil.svg" alt="Editar" @click="selEvent(e)">
                    </div>
                    <div class="event-edit-btn pure-u-1-12 pure-u-md-1-12">
                        <img src="../../img/ico/svg/cerrar-transparente.svg" alt="Eliminar" @click="reqDeleteEvent(e)">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>