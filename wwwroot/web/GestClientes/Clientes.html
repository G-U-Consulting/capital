<div v-if="mode == 0" style="padding: 1em">
    <div class="pure-u-1-24 pure-u-md-1-24"></div>
    <div class="pure-u-22-24 pure-u-md-22-24 menuCard">
        <div class='pure-u-1-1 pure-u-md-1-1 formDivision' style="font-size: 1.5em; margin-bottom: 4px;">
            Administrar Clientes
        </div>
        <div class="searchBox">
            <div class="pure-g">
                <div class="pure-u-1-1 pure-u-md-7-24">
                    <input type="text" placeholder="Ingrese numero de documento o nombre"
                        v-model="filtros.clientes['nombre_id']" maxlength="50" />
                </div>
                <div class="pure-u-1-1 pure-u-md-1-24">
                    <div class="imgGraybutton" @click="onClear('clientes')">
                        <img src="./img/ico/eraser.png" />
                    </div>
                </div>
                <div class="pure-u-1-1 pure-u-md-1-6" style="padding: 0 .5rem;">
                    <input type="text" placeholder="Pais" v-model="filtros.clientes['pais']" maxlength="50" />
                </div>
                <div class="pure-u-1-1 pure-u-md-1-6" style="padding: 0 .5rem;">
                    <input type="text" placeholder="Departamento" v-model="filtros.clientes['departamento']"
                        maxlength="50" />
                </div>
                <div class="pure-u-1-1 pure-u-md-1-6" style="padding: 0 .5rem;">
                    <input type="text" placeholder="Ciudad" v-model="filtros.clientes['ciudad']" maxlength="50" />
                </div>
                <div class="pure-u-1-1 pure-u-md-1-6" style="display: flex; align-items: center; padding-left: .5rem;">
                    <label class="check">
                        <input type="checkbox" v-model="filtros.clientes['is_atencion_rapida']" @change="toggleAtencion"
                            true-value="" false-value="0" />
                        <span class="checkmark"></span>
                        Ver atención rápida
                    </label>
                </div>
            </div>
        </div>
        <div class="main-content">
            <table class="dataTable" style="table-layout: auto;">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Tipo Id.</th>
                        <th>Número Id.</th>
                        <th>Pais</th>
                        <th>Ciudad</th>
                        <th>Dirección</th>
                        <th>Teléfono</th>
                        <th>Email</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="(cli, i) in getFilteredList('clientes')" @click="setIndex(i)" @dblclick="onSelect(cli)"
                        v-bind:class="{'destacada': selIndex === i}">
                        <td>{{cli.nombre}}</td>
                        <td>{{cli.tipo_documento}}</td>
                        <td>{{cli.numero_documento}}</td>
                        <td>{{cli.pais}}</td>
                        <td>{{cli.ciudad}}</td>
                        <td>{{cli.direccion}}</td>
                        <td>{{cli.telefono1 || cli.telefono2}}</td>
                        <td>{{cli.email1 || cli.email2}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<div v-if="mode == 1" style="padding: 1em">
    <div class="pure-u-1-24 pure-u-md-1-24"></div>
    <div class="pure-u-22-24 pure-u-md-22-24 menuCard">
        <div class='pure-u-1-1 pure-u-md-1-1 formDivision' style="font-size: 1.5em; margin-bottom: 4px;">
            Edición Cliente
        </div>
        <div style="height: calc(100vh - 15.5rem); overflow-y: auto;">
            <div class='formDivision' style="margin: .5rem; margin-bottom: 0; padding: 4px 0;">
                Información principal
            </div>
            <div class="pure-u-1-2 pure-u-md-1-2 formInputStandard">
                <label>Nombres</label>
                <input type="text" v-model="cliente.nombres">
            </div>
            <div class="pure-u-1-2 pure-u-md-1-4 formInputStandard">
                <label>Primer Apellido</label>
                <input type="text" v-model="cliente.apellido1">
            </div>
            <div class="pure-u-1-2 pure-u-md-1-4 formInputStandard">
                <label>Segundo Apellido</label>
                <input type="text" v-model="cliente.apellido2">
            </div>

            <div class="pure-u-1-2 pure-u-md-1-4 formInputStandard">
                <label>Pais</label>
                <input type="text" v-model="cliente.pais">
            </div>
            <div class="pure-u-1-2 pure-u-md-1-4 formInputStandard">
                <label>Departamento</label>
                <input type="text" v-model="cliente.departamento">
            </div>
            <div class="pure-u-1-2 pure-u-md-1-4 formInputStandard">
                <label>Ciudad</label>
                <input type="text" v-model="cliente.ciudad">
            </div>
            <div class="pure-u-1-2 pure-u-md-1-4 formInputStandard">
                <label>Barrio</label>
                <input type="text" v-model="cliente.barrio">
            </div>

            <div class='formDivision deployable' @click="showDireccion = !showDireccion">
                <span>Dirección</span>
                <span class="arrow" v-bind:class="{'expanded': showDireccion}">
                    &lt;
                </span>
            </div>
            <div v-show="showDireccion">
                <div class="pure-u-1-1 pure-u-md-1-1 formInputStandard">
                    <label>Dirección</label>
                    <input type="text" v-model="cliente.direccion">
                </div>

                <div class="pure-u-1-2 pure-u-md-1-12 formInputStandard">
                    <label>Tipo Id.</label>
                    <input type="text" v-model="cliente.tipo_documento">
                </div>
                <div class="pure-u-1-2 pure-u-md-1-6 formInputStandard">
                    <label>Número Id.</label>
                    <input type="text" v-model="cliente.numero_documento">
                </div>
                <div class="pure-u-1-2 pure-u-md-1-4 formInputStandard">
                    <label>Pais Expedición</label>
                    <input type="text" v-model="cliente.pais_expedicion">
                </div>
                <div class="pure-u-1-2 pure-u-md-1-4 formInputStandard">
                    <label>Departamento Expedición</label>
                    <input type="text" v-model="cliente.departamento_expedicion">
                </div>
                <div class="pure-u-1-2 pure-u-md-1-4 formInputStandard">
                    <label>Ciudad Expedición</label>
                    <input type="text" v-model="cliente.ciudad_expedicion">
                </div>

                <div class="pure-u-1-2 pure-u-md-1-4 formInputStandard">
                    <label>Email 1</label>
                    <input type="text" v-model="cliente.email1">
                </div>
                <div class="pure-u-1-2 pure-u-md-1-4 formInputStandard">
                    <label>Email 2</label>
                    <input type="text" v-model="cliente.email2">
                </div>
                <div class="pure-u-1-2 pure-u-md-1-4 formInputStandard">
                    <label>Teléfono 1</label>
                    <input type="text" v-model="cliente.telefono1">
                </div>
                <div class="pure-u-1-2 pure-u-md-1-4 formInputStandard">
                    <label>Teléfono 2</label>
                    <input type="text" v-model="cliente.telefono2">
                </div>
            </div>

            <div class='formDivision deployable' @click="showVisitas = !showVisitas">
                <span>Proyectos visitados</span>
                <span class="arrow" v-bind:class="{'expanded': showVisitas}">
                    &lt;
                </span>
            </div>
            <div v-show="showVisitas" style="padding: .5rem;">
                <table class="dataTable" style="table-layout: auto;">
                    <thead>
                        <tr>
                            <th style="width: 17%;">Proyecto</th>
                            <th style="width: 12%;">Fecha</th>
                            <th style="width: 17%;">Medio</th>
                            <th style="width: 14%;">Motivo</th>
                            <th style="width: 40%;">Descripción</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="v in visitas">
                            <td>{{v.proyecto}}</td>
                            <td>{{v.fecha}}</td>
                            <td>{{v.medio}}</td>
                            <td>{{v.motivo_compra}}</td>
                            <td @mouseenter="tooltipVisible = true; tooltipMsg = v.descripcion;"
                                @mouseleave="tooltipVisible = false;" @mousemove="updateCursorRight">
                                {{v.descripcion}}
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div v-if="tooltipVisible && tooltipMsg" class="cursor-tooltip" v-html="tooltipMsg"
                    :style="{ top: tooltipY + 'px', right: tooltipX + 'px' }">
                </div>
            </div>

            <div class='formDivision deployable' @click="showCompras = !showCompras">
                <span>Compras realizadas</span>
                <span class="arrow" v-bind:class="{'expanded': showCompras}">
                    &lt;
                </span>
            </div>
            <div v-show="showCompras" style="padding: .5rem;">
                <table class="dataTable" style="table-layout: auto;">
                    <thead>
                        <tr>
                            <th>Proyecto</th>
                            <th>Torre</th>
                            <th>Unidad</th>
                            <th>Valor</th>
                            <th>Fecha</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>

                        </tr>
                    </tbody>
                </table>
            </div>

            <div class='formDivision deployable' @click="showListas = !showListas">
                <span>En listas de espera</span>
                <span class="arrow" v-bind:class="{'expanded': showListas}">
                    &lt;
                </span>
            </div>
            <div v-show="showListas" style="padding: .5rem;">
                <table class="dataTable" style="table-layout: auto;">
                    <thead>
                        <tr>
                            <th style="width: 6%;">ID</th>
                            <th style="width: 14%;">Fecha</th>
                            <th style="width: 10%;">Doc. Cliente</th>
                            <th style="width: 25%;">Nombre Cliente</th>
                            <th style="width: 14%;">Proyecto</th>
                            <th style="width: 25%;">Asesor</th>
                            <th style="width: 6%;">Alerta</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="l in listas">
                            <td style="text-align: center;">{{l.id_lista}}</td>
                            <td>{{l.created_on}}</td>
                            <td>{{l.numero_documento}}</td>
                            <td>{{l.nombre_cliente}}</td>
                            <td>{{l.proyecto}}</td>
                            <td>{{l.nombre_asesor}}</td>
                            <td style="text-align: center;">{{l.is_waiting == '1' ? 'No' : 'Sí'}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class='formDivision deployable' @click="showDesc = !showDesc">
                <span>Descripción</span>
                <span class="arrow" v-bind:class="{'expanded': showDesc}">
                    &lt;
                </span>
            </div>
            <div v-show="showDesc">
                <div class="pure-u-1-1 formInputStandard">
                    <label>Descripción</label>
                    <textarea rows="5" v-model="cliente.descripcion" style="resize: none; height: auto;">
                    </textarea>
                </div>
            </div>
        </div>

        <div class="pure-u-1-2 pure-u-md-1-5" style="padding-top: .5rem;">
            <button style="background-color: red;" v-if="listas && listas.length" @click="showListas = true;">
                En Listas de Espera
            </button>
        </div>
        <div class="pure-u-1-2 pure-u-md-1-5" style="padding-top: .5rem;">
            <button style="background-color: red;" v-if="cliente.is_vetado == '1'" @click="openModal">
                Sit. Administrativa
            </button>
        </div>
        <div class="pure-u-1-2 pure-u-md-1-5" style="padding-top: .5rem; text-align: center;">
            <button @click="onSave">Guardar</button>
        </div>
        <div class="pure-u-1-2 pure-u-md-2-5" style="padding-top: .5rem; text-align: right;">
            <button @click="mode = 0;">Volver</button>
        </div>
    </div>
</div>

<div class="cal-modal-overlay" id="modalOverlay" @click.stop.prevent="closeModal">
    <div class="modal-container pure-g" style="min-width: 50vw; max-width: 50vw; position: relative;">
        <img src="../../img/ico/svg/cerrar-transparente.svg" @click="closeModal" class="modal-cerrar events">
        <div class="pure-u-1-1">
            <h2 style="text-align: center; margin-bottom: 1rem;">
                Detalles del Veto
            </h2>
        </div>
        <div class="modal-scroll" style="width: 100%; min-height: 20rem">
            <div class="pure-u-3-4 formInputStandard">
                <label>Nombres</label>
                <input type="text" readonly :value="cliente.nombre">
            </div>
            <div class="pure-u-1-4 formInputStandard">
                <label>Número Documento</label>
                <input type="text" readonly :value="cliente.numero_documento">
            </div>
            <div class="pure-u-1-4 formInputStandard">
                <label>Solicitado por</label>
                <input type="text" readonly :value="cliente.veto_solicitado_por">
            </div>
            <div class="pure-u-1-4 formInputStandard">
                <label>Vetado por</label>
                <input type="text" readonly :value="cliente.vetado_por">
            </div>
            <div class="pure-u-1-4 formInputStandard">
                <label>Fecha</label>
                <input type="datetime-local" readonly :value="cliente.fecha_veto">
            </div>

            <div class="pure-u-1-1 formInputStandard">
                <label>Motivo</label>
                <textarea rows="5" v-model="cliente.motivo_veto" style="resize: none; height: auto;">
                    </textarea>
            </div>
        </div>
    </div>
</div>

<div v-if="mode == 'chart'" style="padding: 1em">
    <div class="pure-u-1-24 pure-u-md-1-24"></div>
    <div class="pure-u-22-24 pure-u-md-22-24 menuCard">
        <canvas id="chart-js"></canvas>
    </div>
</div>

<div v-if="mode == 'd3'" style="padding: 1em">
    <div class="pure-u-1-24 pure-u-md-1-24"></div>
    <div class="pure-u-22-24 pure-u-md-22-24 menuCard">
        <div id="d3-js"></div>
    </div>
</div>