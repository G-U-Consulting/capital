<div class="pure-g">
    <div class="pure-u-1-1 pure-u-md-1-5 lateralMenu">
        <div class="lateralMenuHeader">
        </div>
        <div class="lateralMenuGroup">
            <div class="lateralMenuItem noSelect group" style="padding-left: 8px; cursor: auto;">
                Agenda
            </div>
        </div>
        <div class="lateralMenuGroup">
            <div v-on:click="setMainMode(0)" class="lateralMenuItem noSelect" v-bind:class="{'lateralMenuItemSelected': mode == 0}">
                <img src="./img/ico/svg/sidebar/Compromisos.svg" />
                Mis Tareas
            </div>
            <div v-on:click="setMainMode(1)" class="lateralMenuItem noSelect" v-bind:class="{'lateralMenuItemSelected': mode == 1}">
                <img src="./img/ico/svg/sidebar/Mi Calendario.svg" />
                Mi Calendario
            </div>
        </div>
    </div>
    <div class="pure-u-1-1 pure-u-md-4-5">
        <div style="font-size: 1rem; font-weight: 500; border-bottom: 1px solid rgb(231, 231, 231); padding: 1rem;">
            <div style="display: inline;" v-for="(r, i) in ruta.filter(r => r.text)" @click="r.action">
                <span class="hoverLink">{{ r.text }}</span>
                <span v-if="i < ruta.length - 1"> / </span>
            </div>
        </div>
        <div v-if="mode == 0" style="padding: 1em">
            <div class="pure-u-1-24 pure-u-md-1-24"></div>
            <div class="pure-u-22-24 pure-u-md-22-24 menuCard">
                <h2 style="margin-bottom: .5rem;">{{usuario.nombres}}</h2>
                <div class='pure-u-1-1 pure-u-md-1-1 formDivision' style="font-size: 1.5em; margin-bottom: 4px;">
                    Fecha de hoy: {{ new Date().toLocaleDateString() }}
                </div>
        
                <div class='pure-u-1-2 pure-u-md-1-12' style="text-align: center; padding-top: 14px;">
                    <label for="sel-pro" style="padding-top: .5rem;">Proyecto: </label>
                </div>
                <div class='pure-u-1-2 pure-u-md-1-6 formInputStandard'>
                    <select v-model="selPro" class="pure-input-1" @change="onChangePro" id="sel-pro">
                        <option :value="{}">[Todos]</option>
                        <option v-for="pro in proyectos" :value="pro">{{pro.nombre}}</option>
                    </select>
                </div>
                <div class='pure-u-1-1 pure-u-md-1-24'></div>
                <div class='pure-u-1-1 pure-u-md-1-4' style="padding-top: 14px;">
                    <label class="check">
                        <input type="checkbox" :checked="filtros.tareas.activa" @change="onChangeActive" />
                        <span class="checkmark"></span>
                        Mostrar solo tareas activas
                    </label>
                </div>
                <div class='pure-u-1-1 pure-u-md-1-12' style="text-align: center; padding-top: 14px;">
                    <label for="sel-orden">Orden: </label>
                </div>
                <div class='pure-u-1-1 pure-u-md-1-6 formInputStandard' style="text-align: left;">
                    <select id="sel-orden" v-model="orden">
                        <option value="dead-prio">Deadline - Prioridad</option>
                        <option value="prio-dead">Prioridad - Deadline</option>
                    </select>
                </div>
                <div class='pure-u-1-1 pure-u-md-5-24' style="text-align: right; padding-top: .5rem;">
                    <button @click="newRow()">Agregar Tarea</button>
                </div>
        
                <div style="height: calc(100vh - 25rem); overflow-y: auto;">
                    <table class="dataTable" style="table-layout: auto;">
                        <thead>
                            <tr>
                                <th style="width: 13%;">Alta</th>
                                <th style="width: 13%;">Deadline</th>
                                <th style="width: 16%;">Proyecto</th>
                                <th style="width: 32%;">Descripci√≥n</th>
                                <th style="width: 13%;">Prioridad</th>
                                <th style="width: 13%;">Estado</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-if="editNewRow" class="editable" v-bind:class="{'destacada': selRow == null}">
                                <td><input type="date" v-model="tarea.alta"></td>
                                <td><input type="date" v-model="tarea.deadline"></td>
                                <td>
                                    <select v-model="tarea.id_proyecto">
                                        <option value="" disabled>[Seleccione]</option>
                                        <option v-for="pro in proyectos" :value="pro.id_proyecto">{{pro.nombre}}</option>
                                    </select>
                                </td>
                                <td><input type="text" v-model="tarea.descripcion"></td>
                                <td>
                                    <select v-model="tarea.id_prioridad">
                                        <option value="" disabled>[Seleccione]</option>
                                        <option v-for="p in prioridades" :value="p.id_prioridad">{{p.nombre}}</option>
                                    </select>
                                </td>
                                <td>
                                    <select v-model="tarea.id_estado">
                                        <option value="" disabled>[Seleccione]</option>
                                        <option v-for="e in estados" :value="e.id_estado">{{e.nombre}}</option>
                                    </select>
                                </td>
                            </tr>
                            <tr v-for="(t, i) in getFilteredList('tareas')" @click="onSelect(t, i)"
                                v-bind:class="{'destacada': selRow == i, 'editable': enableEdit && selRow == i, 'deshabilitada': t.id_estado == '4'}">
                                <td>
                                    <input type="date" v-model="t.alta" v-if="enableEdit && selRow == i">
                                    <span v-else>{{t.alta}}</span>
                                </td>
                                <td>
                                    <input type="date" v-model="t.deadline" v-if="enableEdit && selRow == i">
                                    <span v-else>{{t.deadline}}</span>
                                </td>
                                <td>
                                    <select v-model="t.id_proyecto" v-if="enableEdit && selRow == i">
                                        <option value="" disabled>[Seleccione]</option>
                                        <option v-for="pro in proyectos" :value="pro.id_proyecto">{{pro.nombre}}</option>
                                    </select>
                                    <span v-else>{{t.proyecto}}</span>
                                </td>
                                <td>
                                    <input type="text" v-model="t.descripcion" v-if="enableEdit && selRow == i">
                                    <span v-else>{{t.descripcion}}</span>
                                </td>
                                <td style="text-align: center;">
                                    <select v-model="t.id_prioridad" v-if="enableEdit && selRow == i">
                                        <option value="" disabled>[Seleccione]</option>
                                        <option v-for="p in prioridades" :value="p.id_prioridad">{{p.nombre}}</option>
                                    </select>
                                    <span v-else>{{t.prioridad}}</span>
                                </td>
                                <td style="text-align: center;">
                                    <select v-model="t.id_estado" v-if="enableEdit && selRow == i">
                                        <option value="" disabled>[Seleccione]</option>
                                        <option v-for="e in estados" :value="e.id_estado">{{e.nombre}}</option>
                                    </select>
                                    <span v-else>{{t.estado}}</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
        
                <div class='pure-u-1-1 pure-u-md-7-12'></div>
                <div class='pure-u-1-1 pure-u-md-5-24' style="text-align: center; padding-top: .5rem;">
                    <button @click="enableEdit = true">Editar Tarea</button>
                </div>
                <div class='pure-u-1-1 pure-u-md-5-24' style="text-align: center; padding-top: .5rem;">
                    <button @click="reqDelete">Eliminar Tarea</button>
                </div>
            </div>
            <div class='pure-u-1-1 pure-u-md-2-5'></div>
            <div class='pure-u-1-1 pure-u-md-1-5' style="text-align: center; padding-top: 1rem;">
                <button @click="onSave">Guardar</button>
            </div>
        </div>
        <div v-if="mode == 1" style="padding: 1em;">
            <div style="display: flex; justify-content: center; align-items: center; height: calc(100dvh - 10rem);">
                <div>
                    <img src="../../img/background/MEN AT WORK.JPG" alt="">
                </div>
            </div>
        </div>
    </div>