<div v-if="mode == 0" style="padding: 1em">
    <div class="pure-u-1-24 pure-u-md-1-24"></div>
    <div class="pure-u-22-24 pure-u-md-22-24 menuCard">
        <div class='pure-u-1-1 pure-u-md-1-1 formDivision' style="font-size: 1.5em; margin-bottom: 4px;">
            Trazabilidad
        </div>
        <div style="height: calc(100vh - 13rem); overflow-y: auto;">
            <table class="dataTable">
                <thead>
                    <tr>
                        <th style="width: 20%;">Proyecto</th>
                        <th style="width: 15%;">Sede</th>
                        <th style="width: 25%;">Zona</th>
                        <th style="width: 25%;">Ciudadela</th>
                        <th style="width: 15%;">Ver</th>
                    </tr>
                </thead>
                <tbody>
                    <template v-for="p in proyectos">
                        <tr @dblclick="toggleProject(p)">
                            <td>{{p.nombre}}</td>
                            <td>{{p.sede}}</td>
                            <td>{{p.zona_proyecto}}</td>
                            <td>{{p.ciudadela}}</td>
                            <td>
                                <button @click="toggleProject(p)">Ver Torres</button>
                            </td>
                        </tr>
                        <tr :style="`display: ${p.showDetails ? 'table-row' : 'none'};`">
                            <td colspan="5">

                                <table class="dataTable">
                                    <thead>
                                        <tr>
                                            <th style="width: 15%;">Torre</th>
                                            <th style="width: 20%;">ID Sinco</th>
                                            <th style="width: 35%;">Fiduciaria</th>
                                            <th style="width: 15%;">En venta</th>
                                            <th style="width: 15%;">Ver</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <template v-for="t in p.torres">
                                            <tr @dblclick="toggleTower(t)">
                                                <td>{{t.consecutivo}}</td>
                                                <td>{{t.id_sinco}}</td>
                                                <td>{{t.fiduciaria}}</td>
                                                <td>{{t.en_venta == '1' ? 'SÃ­' : 'No'}}</td>
                                                <td>
                                                    <button @click="toggleTower(t)">Ver Unidades</button>
                                                </td>
                                            </tr>
                                            <tr :style="`display: ${t.showDetails ? 'table-row' : 'none'};`">
                                                <td colspan="5">

                                                    <table class="dataTable">
                                                        <thead>
                                                            <tr>
                                                                <th style="width: 20%;">Unidad</th>
                                                                <th style="width: 15%;">Piso</th>
                                                                <th style="width: 25%;">Clase</th>
                                                                <th style="width: 20%;">Tipo</th>
                                                                <th style="width: 20%;">Estado</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr v-for="u in t.unidades" @dblclick="onSelect(u)">
                                                                <td>{{u.unidad}}</td>
                                                                <td>{{u.piso}}</td>
                                                                <td>{{u.clase}}</td>
                                                                <td>{{u.tipo}}</td>
                                                                <td>{{u.estado_unidad}}</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>

                                                </td>
                                            </tr>
                                        </template>
                                    </tbody>
                                </table>

                            </td>
                        </tr>
                    </template>
                </tbody>
            </table>
        </div>
    </div>
</div>

<div v-if="mode == 1" style="padding: 1em">
    <div class="pure-u-1-24 pure-u-md-1-24"></div>
    <div class="pure-u-22-24 pure-u-md-22-24 menuCard">
        <div class='pure-u-1-1 pure-u-md-1-1 formDivision' style="font-size: 1.5em; margin-bottom: 4px;">
            Historial de cambios: {{unidad.unidad}}
        </div>

        <div class="pure-u-1-1" style="background: #f4f6f8; height: calc(100vh - 13rem); overflow-y: auto;">
            <div class="log-container">
                <div class="log-entry" v-for="log in unidad.logs">
                    <div class="log-header">
                        <div class="log-title" v-html="log.titulo"></div>
                        <div class="log-date">{{log.fecha}}</div>
                    </div>
                    <div class="log-content" v-html="log.texto"></div>
                    <div class="log-footer">
                        Responsable: {{log.usuario}}
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>